const Apollo = {
    version: 20250614,
    empty: "hiker://empty",
    url: getItem("link", "https://www.w91h.com"),
    d: [],
    data: {
        category: getMyVar('Apo.category', '0'),
        subCate: getMyVar('Apo.subCate', '0'),
    },
    getRangeColors: function() {
        return '#' + ('00000' + (Math.random() * 0x1000000 << 0)
                .toString(16))
            .substr(-6);
    }, //ÈöèÊú∫È¢úËâ≤
    baseParse: () => {
        const page = parseInt(MY_URL.split('##')[2])
        let categoryList = [{
            "title": "Êñ∞",
            "path": "/cn/vl_update.php",
            "type": "video",
            "sub": [{
                "title": "Êñ∞ËØùÈ¢ò",
                "path": "/cn/vl_update.php",
            }, {
                "title": "Êñ∞Âä†ÂÖ•",
                "path": "/cn/vl_newentries.php",
            }, {
                "title": "‰æùÂàÜÁ±ª",
                "path": "/cn/genres.php",
            }]
        }, {
            "title": "üîé",
            "path": "/cn/search.php",
            "type": "video",
            "sub": []
        }, {
            "title": "Êî∂",
            "path": "/cn/mv_wanted.php?thumb&sort=saledate",
            "type": "video",
            "sub": [{
                "title": "üóØÁæé‰π≥üóØ",
                "path": "/cn/mv_wanted.php?thumb&sort=saledate",
            }, {
                "title": "üóØÈï∑Ë∫´üóØ",
                "path": "/cn/mv_watched.php?thumb&sort=saledate",
            }, {
                "title": "üóØÁªù‰∏ñüóØ",
                "path": "/cn/mv_owned.php?thumb&sort=saledate",
            }]
        }, {
            "title": "Ëóè",
            "path": "/cn/mv_favstars.php",
            "type": "actress",
            "sub": [{
                "title": "üóØÊºîÂì°",
                "path": "/cn/mv_favstars.php"
            }, {
                "title": "üóØÂ∞éÊºî",
                "path": "/cn/mv_favdirectors.php"
            }, {
                "title": "üóØË£Ω‰ΩúÂïÜ",
                "path": "/cn/mv_favmakers.php"
            }, {
                "title": "üóØÁôºË°åÂïÜüóØ",
                "path": "/cn/mv_favlabels.php"
            }]
        }, {
            "title": "Êñ∞Âèë",
            "path": "/cn/vl_newrelease.php",
            "type": "video",
            "sub": [{
                "title": "Êñ∞ÂèëË°åÔºàÊúâËØÑËÆ∫Ôºâ",
                "path": "/cn/vl_newrelease.php?&mode=1"
            }, {
                "title": "Êñ∞ÂèëË°åÔºàÊâÄÊúâÁöÑÔºâ",
                "path": "/cn/vl_newrelease.php?&mode=2"
            }]
        }, {
            "title": "ÊúÄÊÉ≥",
            "path": "/cn/vl_mostwanted.php",
            "type": "video",
            "sub": [{
                "title": "ÊúÄÊÉ≥Ë¶ÅÔºà‰∏ä‰∏™ÊúàÔºâ",
                "path": "/cn/vl_mostwanted.php?&mode=1"
            }, {
                "title": "ÊúÄÊÉ≥Ë¶ÅÔºàÊâÄÊúâÁöÑÔºâ",
                "path": "/cn/vl_mostwanted.php?&mode=2"
            }]
        }, {
            "title": "È´òËØÑ",
            "path": "/cn/vl_bestrated.php",
            "type": "video",
            "sub": [{
                "title": "È´òËØÑ‰ª∑Ôºà‰∏ä‰∏™ÊúàÔºâ",
                "path": "/cn/vl_bestrated.php?&mode=1"
            }, {
                "title": "È´òËØÑ‰ª∑ÔºàÊâÄÊúâÁöÑÔºâ",
                "path": "/cn/vl_bestrated.php?&mode=2"
            }]
        }, {
            "title": "ÊºîÂì°",
            "path": "/cn/star_list.php?prefix=A",
            "type": "actress",
            "sub": [{
                "title": "ÊéíË°åÊ¶ú",
                "path": "/cn/star_mostfav.php"
            }, {
                "title": "A",
                "path": "/cn/star_list.php?prefix=A"
            }, {
                "title": "B",
                "path": "/cn/star_list.php?prefix=B"
            }, {
                "title": "C",
                "path": "/cn/star_list.php?prefix=C"
            }, {
                "title": "D",
                "path": "/cn/star_list.php?prefix=D"
            }, {
                "title": "E",
                "path": "/cn/star_list.php?prefix=E"
            }, {
                "title": "F",
                "path": "/cn/star_list.php?prefix=F"
            }, {
                "title": "G",
                "path": "/cn/star_list.php?prefix=G"
            }, {
                "title": "H",
                "path": "/cn/star_list.php?prefix=H"
            }, {
                "title": "I",
                "path": "/cn/star_list.php?prefix=I"
            }, {
                "title": "J",
                "path": "/cn/star_list.php?prefix=J"
            }, {
                "title": "K",
                "path": "/cn/star_list.php?prefix=K"
            }, {
                "title": "L",
                "path": "/cn/star_list.php?prefix=L"
            }, {
                "title": "M",
                "path": "/cn/star_list.php?prefix=M"
            }, {
                "title": "N",
                "path": "/cn/star_list.php?prefix=N"
            }, {
                "title": "O",
                "path": "/cn/star_list.php?prefix=O"
            }, {
                "title": "P",
                "path": "/cn/star_list.php?prefix=P"
            }, {
                "title": "Q",
                "path": "/cn/star_list.php?prefix=Q"
            }, {
                "title": "R",
                "path": "/cn/star_list.php?prefix=R"
            }, {
                "title": "S",
                "path": "/cn/star_list.php?prefix=S"
            }, {
                "title": "T",
                "path": "/cn/star_list.php?prefix=T"
            }, {
                "title": "U",
                "path": "/cn/star_list.php?prefix=U"
            }, {
                "title": "V",
                "path": "/cn/star_list.php?prefix=V"
            }, {
                "title": "W",
                "path": "/cn/star_list.php?prefix=W"
            }, {
                "title": "X",
                "path": "/cn/star_list.php?prefix=X"
            }, {
                "title": "Y",
                "path": "/cn/star_list.php?prefix=Y"
            }, {
                "title": "Z",
                "path": "/cn/star_list.php?prefix=Z"
            }]
        }, {
            "title": "ÁôªÂΩï",
            "path": "/cn/myaccount.php",
            "type": "login",
            "sub": []
        }]
        const currentCate = categoryList[Apollo.data.category]
        let url
        let type = currentCate.type
        let path = currentCate.path
        if (currentCate.sub.length > 0) {
            url = Apollo.url + getMyVar("url", currentCate.sub[Apollo.data.subCate].path)
            path = currentCate.sub[Apollo.data.subCate].path
        } else {
            url = Apollo.url + getMyVar("url", currentCate.path)
        }
        url = url.replace(/https?.*(https?.*)/, "$1")
        if (page === 1) {
            categoryList.forEach((cate, index) => {
                Apollo.d.push({
                    title: parseInt(Apollo.data.category) === index ? '‚Äú‚Äú‚Äù‚Äù' + cate.title.fontcolor(Apollo.getRangeColors()) : cate.title,
                    url: $(Apollo.empty + "#noLoading#")
                        .lazyRule((index) => {
                            putMyVar("Apo.category", index.toString())
                            putMyVar("Apo.subCate", '0')
                            clearMyVar("url")
                            clearMyVar("yurl");
                            refreshPage(true)
                            return "hiker://empty"
                        }, index),
                    col_type: 'scroll_button',
                })
            })
            if (currentCate.sub.length > 0) {
                Apollo.d.push({
                    col_type: 'blank_block',
                })
                currentCate.sub.forEach((cate, index) => {
                    Apollo.d.push({
                        title: parseInt(Apollo.data.subCate) === index ? '‚Äú‚Äú‚Äù‚Äù' + cate.title.fontcolor(Apollo.getRangeColors()) : cate.title,
                        url: $(Apollo.empty + "#noLoading#")
                            .lazyRule((index) => {
                                putMyVar("Apo.subCate", index.toString())
                                clearMyVar("url")
                                clearMyVar("yurl");
                                refreshPage(true)
                                return "hiker://empty"
                            }, index),
                        col_type: 'scroll_button',
                    })
                })
            }
        }
        if (MY_PAGE == 1 && !/genres\.php|search\.php/.test(url)) {
            Apollo.d.push({
                title: "üîç",
                url: $.toString((host) => {
                    putMyVar('keyword', input);
                    var searchUrl = host + "/cn/vl_searchbyid.php?keyword=" + input;
                    try {
                        var url = JSON.parse(fetch(searchUrl, {
                            onlyHeaders: true
                        })).url;
                        if (url == searchUrl) {
                            putMyVar("url", searchUrl);
                            refreshPage(true);
                            return "hiker://empty"
                        } else {
                            return url + $('#noHistory#')
                                .rule(() => {
                                    const Apollo = $.require('hiker://page/Apollo')
                                    try {
                                        Apollo.videoParse(MY_URL)
                                    } catch {
                                        Apollo.d.push({
                                            title: '‚Äú‚Äú‚Äù‚Äù' + "Âè™ÂèØÊêúÁï™Âè∑Ôºå‰∏≠ÊñáÊàñÈîôËØØÁï™Âè∑Êä•Èîô".fontcolor("#67E0FA"),
                                            url: "hiker://empty",
                                            col_type: "text_center_1",
                                            extra: {
                                                lineVisible: false
                                            }
                                        })
                                    }
                                    setResult(Apollo.d)
                                })
                        }
                    } catch {
                        return "hiker://empty"
                    }
                }, Apollo.url),
                desc: 'Âø´Êç∑Áï™Âè∑ÊêúÁ¥¢...',
                col_type: "input",
                extra: {
                    defaultValue: getMyVar('keyword', '') || "",
                    pageTitle: "üîéÊêúÁ¥¢ÁªìÊûú"
                }
            });
        }
        //ÁøªÈ°µ
        /*
        if (page !== 1) {
            url = url.includes("?") ? url + "&page=" + page : url + "?&page=" + page
        }
        const html = fetch(url, {
            headers: {
                "Cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
            }
        })*/
        let nextPage = getMyVar("nextPage", "");
        if (nextPage && MY_PAGE > 1) {
            url = nextPage;
        } else if (MY_PAGE > 1) {
            url = "Ê≤°Êúâ‰∏ã‰∏ÄÈ°µÂì¶üòë"
        }
        const html = fetch(url, {
            headers: {
                "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "user-agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046285 Mobile Safari/537.36"
            }
        })
        Apollo.HostParse(url, html)
        log(url)
        try {
            var next = pdfh(html, ".page_selector&&.page:matches(‰∏ã‰∏ÄÈ°µ)&&a&&href")
            next = next.includes("cn") ? Apollo.url + next : Apollo.url + "/cn/" + next;
            putMyVar("nextPage", next);
        } catch {
            clearMyVar("nextPage");
            // log("ÂèØËÉΩ‰∏çÂ≠òÂú®‰∏ã‰∏ÄÈ°µÊàñËÄÖ‰∏ã‰∏ÄÈ°µÂÆö‰ΩçÊúâÈóÆÈ¢ò");
        }

        if (url.includes("searchbyid")) {
            Apollo.d.push({
                title: '‚Äú‚Äú‚Äù‚Äù' + "ËØÜÂà´Á†ÅÊêúÂØªÁªìÊûú".fontcolor("#67E0FA"),
                url: "hiker://empty",
                col_type: "text_1",
                extra: {
                    lineVisible: false
                }
            })
        }

        switch (type) {
            case 'video':
                if (url.includes("genres.php")) {
                    Apollo.seriesType(html)
                } else {
                    Apollo.videoType(url, html)
                }
                break
            case 'actress':
                Apollo.avatarType(html)
                break
            case 'series':
                Apollo.seriesType(html)
                break
            case 'login':
                Apollo.loginType(html)
                break
            default:
                Apollo.videoType(url, html)
        }
        setResult(Apollo.d)
    },

    //ÁôªÂΩï
    loginType: (html) => {
        if (html.includes("ÈªëÂêçÂçï")) {
            Apollo.d.push({
                title: '‚Äú‚Äú‚Äù‚Äù<big><font color=#118811>Ë¥¶Âè∑Â∑≤ÁôªÂΩï,ÁÇπÂáªÈÄÄÂá∫Ë¥¶Âè∑</font></big>',
                desc: '‚Äú‚Äú‚Äù‚Äù' + 'ÂàáÊç¢ÂàÜÁ±ªÂà∑Êñ∞È°µÈù¢ÂÜÖÂÆπ'.fontcolor('#FF0000').big(),
                url: 'hiker://empty' + $('').lazyRule(() => {
                    writeFile('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt', '');
                    const Apollo = $.require('hiker://page/Apollo')
                    fetch(Apollo.url + "/cn/logout.php", {
                        headers: {
                            cookie: fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                            "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                        }
                    })
                    refreshPage();
                    return "toast://Ë¥¶Âè∑Â∑≤ÁôªÂá∫";
                }),
                col_type: 'text_center_1',
                extra: {
                    lineVisible: false
                }
            });
        } else {
            Apollo.d.push({
                title: '‚Äú‚Äú‚Äù‚Äù' + 'ÁÇπÂáªÁôªÂΩïË¥¶Âè∑'.fontcolor('#FF00FF').big(),
                url: Apollo.url + "/cn/login.php" + $('').rule(() => {
                    var d = [];
                    d.push({
                        col_type: 'x5_webview_single',
                        url: MY_URL,
                        desc: 'list&&screen',
                        extra: {
                            "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36", //PC_UA,             
                            showProgress: false,
                            js: $.toString((u) => {
                                function check() {
                                    //let nodes = document.querySelectorAll('#tags');
                                    // var ua = fba.getUa()
                                    // fba.log('co::::::' + ua);
                                    var htmlContent = document.documentElement.innerHTML;

                                    if (/Âü∫Êú¨ËµÑÊñô/.test(htmlContent)) {
                                        // if (co.includes('USERKEY') && co.includes('PHPSESSID')) {
                                        var co = fba.getCookie(u);
                                        fba.log('co::::::' + co);
                                        fba.parseLazyRule($$$().lazyRule((co) => {
                                            writeFile('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt', co);
                                            toast('Ë¥¶Âè∑Â∑≤ÁôªÂΩï');
                                            back(true);
                                        }, co));
                                    } else {
                                        setTimeout(check, 500);
                                    }
                                }
                                check();
                            }, MY_URL)
                        }
                    });
                    return setResult(d);
                }),
                col_type: 'text_center_1',
                extra: {
                    lineVisible: false,
                }
            });
        }
    },

    //‰∏ÄÁ∫ßËßÜÈ¢ëÂàóË°®
    videoType: (url, html) => {
        try {
            var currpagenum = pdfh(html, ".page_selector&&.current&&Text")
        } catch {
            var currpagenum = "1"
        }
        try {
            var lastpagenum = pdfh(html, ".page_selector&&.last&&a&&href").match(/.*?page=(\d+)/)[1]
        } catch {
            var lastpagenum = currpagenum
        }
        var list = pdfa(html, ".videothumblist&&.video");
        list.forEach(item => {
            var vurl = pdfh(item, 'a&&href').replace(".", "");
            vurl = vurl.includes("cn") ? Apollo.url + vurl : Apollo.url + "/cn" + vurl
            Apollo.d.push({
                title: pdfh(item, "a&&title"),
                desc: pdfh(item, ".id&&Text"),
                img: pdfh(item, "img&&src").replace("ps.", "pl."),
                url: vurl + $('#noHistory#')
                    .rule(() => {
                        const Apollo = $.require('hiker://page/Apollo')
                        Apollo.videoParse(MY_URL)
                        setResult(Apollo.d)
                    }),
                col_type: "movie_2",
                extra: {
                    pageTitle: pdfh(item, "a&&title"),
                    longClick: !url.includes("movie") ? [{
                        title: '„ÄêË∑≥È°µ„Äë„ÄêÂΩìÂâçÁ¨¨>' + currpagenum + '<È°µ„Äë„ÄêÂ∞æÈ°µ=>' + lastpagenum + 'È°µ„Äë',
                        js: $.toString((lastpagenum, url) => {
                                return $('', 'Ê≠£Á°ÆÁöÑÈ°µÁ†ÅÔºö1=>' + lastpagenum + "È°µ")
                                    .input((url, lastpagenum) => {
                                            if (input > 0 && input % 1 == 0 && input <= parseInt(lastpagenum)) {
                                                var jumpu = url.replace(/(\?page=\d+|\&page=\d+|$)/, (match) => {
                                                    if (match.startsWith('?page=') || match.startsWith('&page=')) {
                                                        return match.charAt(0) + 'page=' + input;
                                                    } else {
                                                        return (url.includes('?') ? '&page=' : '?page=') + input;
                                                    }
                                                });
                                                putMyVar("url", jumpu);
                                                putMyVar("yurl", jumpu);
                                                refreshPage();
                                                return 'toast://‰Ω†Â∑≤ÁªèÁ©øË∂äÂà∞‰∫Ü' + input + 'È°µ'
                                            } else {
                                                return "toast://ËØ∑ËæìÂÖ•Ê≠£Á°ÆÁöÑÈ°µÁ†Å"
                                            }
                                        },
                                        url, lastpagenum)
                            },
                            lastpagenum, url)
                    }] : ""
                }
            })
        })
    },

    //‰∏ÄÁ∫ßÁ≥ªÂàó
    seriesType: (html) => {
        var tabs = pdfa(html, '#rightcolumn&&.textbox');
        var conts = pdfa(html, '#rightcolumn&&.textbox');
        for (var i = 0; i < tabs.length; i++) {
            var line = pdfh(tabs[i], '.boxtitle&&Text');
            var num = '<small><span style="color:#19B89D">' + (i + 1) + '</span>/' + conts.length + '</small>';
            var icon_s = 'https://hikerfans.com/weisyr/icon/';
            var list = pdfa(conts[i], 'body&&a');
            var avatar = icon_s + 'Ê≠£Â∫è.svg';
            Apollo.d.push({
                title: line.fontcolor("#FF00FF"),
                desc: num,
                url: "hiker://empty",
                col_type: 'avatar',
                img: avatar,
            });
            for (var j = 0; j < list.length; j++) {
                var jm = pdfh(list[j], 'a&&Text');
                var url = Apollo.url + "/cn/" + pdfh(list[j], 'a&&href');
                Apollo.d.push({
                    title: '‚Äú‚Äú‚Äù‚Äù' + jm.fontcolor(Apollo.getRangeColors()),
                    url: $(url + '#fypage#noHistory#')
                        .rule(() => {
                            const Apollo = $.require('hiker://page/Apollo')
                            Apollo.avatarParse(MY_URL)
                            setResult(Apollo.d)
                        }),
                    col_type: "text_4",
                    extra: {},
                });
            }
        }
    },
    //‰∏ÄÁ∫ßÊºîÂëò
    avatarType: (html) => {
        try {
            var list = pdfa(html, '.videotextlist&&tr:not(.header)')
            var action = pdfh(html, "#rightcolumn&&form&&action");
            action = action.includes("cn") ? Apollo.url + action : Apollo.url + "/cn/" + action;
            list = list.length > 0 ? list : pdfa(html, 'body&&.starbox>div')
            list.forEach(item => {
                var url = pdfh(item, 'a&&href');
                var value = pdfh(item, 'input&&value')
                url = url.includes("cn") ? Apollo.url + url : Apollo.url + "/cn/" + url;
                var img = pdfh(item, 'img&&src');
                Apollo.d.push({
                    title: '‚Äú‚Äú‚Äù‚Äù' + pdfh(item, 'a&&Text')
                        .fontcolor(Apollo.getRangeColors()),
                    desc: "",
                    img: img ? "https:" + img : "",
                    url: $(url + '#fypage#noHistory#')
                        .rule(() => {
                            const Apollo = $.require('hiker://page/Apollo')
                            Apollo.avatarParse(MY_URL)
                            setResult(Apollo.d)
                        }),
                    col_type: img ? "card_pic_3" : 'flex_button',
                    extra: {
                        longClick: html.includes("ÈªëÂêçÂçï") ? [{
                            title: '‚ùóÔ∏èÂèñÊ∂àÊî∂Ëóè',
                            js: $.toString((value, action) => {
                                var result = post(action, {
                                    headers: {
                                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                                    },
                                    body: {
                                        "selectedVideos[]": value,
                                    }
                                });
                                if (result.includes("Ë¢´ÁßªÈô§‰∫Ü")) {
                                    refreshPage();
                                    return "toast://ÂèñÊ∂àÊî∂ËóèÊàêÂäüÔºÅ"
                                } else {
                                    return "toast://ÂèñÊ∂àÊî∂ËóèÂ§±Ë¥•ÔºÅ"
                                }
                            }, value, action)
                        }] : ""
                    }
                })
            })
        } catch {}
        Apollo.d.push({
            col_type: "blank_block"
        })
    },
    //‰∏ÄÁ∫ßÁÆÄÈ°∂ÈÉ®ÂàÜÁ±ª
    videoSort1: (html) => {
        if (MY_PAGE == 1) {
            Apollo.d.push({
                col_type: "blank_block",
            })
            var change = pdfh(html, ".displaymode&&select&&onchange")
            var url1 = change.split("'")[1]
            var url3 = change.split("'")[3]
            const sort = pdfa(html, '.displaymode&&select&&option')
            sort.forEach((item, index) => {
                var title = pdfh(item, 'Text').replace(/(.*)\Ôºà.*\Ôºâ/, "$1");
                Apollo.d.push({
                    title: getMyVar('ysort', '0') == index ? '‚Äò‚Äò‚Äô‚Äô<strong><font color="#ff1493">' + title + '</font></strong>' : title,
                    url: Apollo.url + url1 + pdfh(item, 'option&&value') + url3 + $('#noLoading#')
                        .lazyRule((index) => {
                            putMyVar('ysort', index);
                            putMyVar("yurl", input);
                            refreshPage();
                            return 'hiker://empty'
                        }, index),
                    col_type: 'scroll_button'
                })
            })
        }
    },
    //‰∏ÄÁ∫ßÈ°µÈù¢.ÁÆÄ
    avatarParse: (url) => {
        addListener("onClose", $.toString(() => {
            clearMyVar("yurl");
            clearMyVar("ysort");
            clearMyVar("nextPage1");
        }));
        url = url.replace(/(.*?)#.*/, "$1");
        url = getMyVar("yurl", url)
            .replace(/(.*?)#.*/, "$1");
        /*
        if (MY_PAGE !== 1) {
            url = url.includes("?") ? url + "&page=" + MY_PAGE : url + "?&page=" + MY_PAGE
        }
        const html = fetch(url, {
            headers: {
                "Cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
            }
        })
        log(url)*/
        let nextPage = getMyVar("nextPage1", "");
        if (nextPage && MY_PAGE > 1) {
            url = nextPage;
        } else if (MY_PAGE > 1) {
            url = "Ê≤°Êúâ‰∏ã‰∏ÄÈ°µÂì¶üòë"
        }
        var html = fetch(url, {
            headers: {
                "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
            }
        })
        log(url)
        try {
            var next = pdfh(html, ".page_selector&&.page:matches(‰∏ã‰∏ÄÈ°µ)&&a&&href")
            next = next.includes("cn") ? Apollo.url + next : Apollo.url + "/cn/" + next
            putMyVar("nextPage1", next);
        } catch {
            clearMyVar("nextPage1");
            // log("ÂèØËÉΩ‰∏çÂ≠òÂú®‰∏ã‰∏ÄÈ°µÊàñËÄÖ‰∏ã‰∏ÄÈ°µÂÆö‰ΩçÊúâÈóÆÈ¢ò");
        }
        Apollo.videoSort1(html);
        Apollo.videoType(url, html)
    },

    //ÊêúÁ¥¢
    searchParse: (url) => {
        url = Apollo.url + url.replace("hiker://empty##", "")
        log(url)
        var html = fetch(url, {
            headers: {
                "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
            },
        });
        if (!html.includes("ËØÜÂà´Á†ÅÊêúÂØªÁªìÊûú")) {
            Apollo.d.push({
                title: MY_KEYWORD,
                desc: "Â∞èÊí∏ÊÄ°ÊÉÖÔºåÂ§ßÊí∏‰º§Ë∫´",
                url: $(url + '#noHistory#')
                    .rule(() => {
                        const Apollo = $.require('hiker://page/Apollo')
                        Apollo.videoParse(MY_URL)
                        setResult(Apollo.d)
                    }),
                col_type: "movie_2",
            })
        } else {
            Apollo.videoType(url, html)
        }
        setResult(Apollo.d)
    },

    //‰∫åÁ∫ß
    videoParse: (url) => {
        addListener("onClose", () => {
            clearMyVar("piclist");
        });
        log(url)
        var yiji = $('#fypage#noHistory#')
            .rule(() => {
                const Apollo = $.require('hiker://page/Apollo')
                Apollo.avatarParse(MY_URL)
                setResult(Apollo.d)
            })
        const html = fetch(url, {
            headers: {
                "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
            }
        })
        try {
            var title = pdfh(html, "#rightcolumn&&h3&&Text")
                .replace("ÂÖçË¥πAVÂú®Á∫øÁúã", "");
            var desct = title;
            Apollo.d.push({
                title: '‚Äú‚Äú‚Äù‚Äù' + title.fontcolor("#E57A1A").small(),
                url: "hiker://empty" + $('#noLoading#')
                    .lazyRule((desct) => {
                        var desc = findItem('transdesc')
                            .desc
                        if (!desc) {
                            const Apollo = $.require('hiker://page/Apollo')
                            var translates = Apollo.translate(desct)
                            updateItem("transdesc", {
                                desc: '‚Äú‚Äú‚Äù‚Äù' + translates.fontcolor("red"),
                            })
                        } else {
                            updateItem("transdesc", {
                                desc: '',
                            })
                        }
                        return "hiker://empty"
                    }, desct),
                col_type: 'text_1',
                extra: {
                    lineVisible: false,
                    id: 'transdesc',
                    longClick: [{
                        title: 'ÁΩëÈ°µ',
                        js: $.toString(() => {
                            return "web://" + MY_URL
                        })
                    }, {
                        title: 'Â§çÂà∂',
                        js: $.toString((title) => {
                            return "copy://" + title;
                        }, title)
                    }, {
                        title: 'ÁôæÂ∫¶ÁøªËØë',
                        js: $.toString((title) => {
                            return "x5://https://fanyi.baidu.com/#jp/zh/" + title
                        }, title)
                    }, {
                        title: 'DeeplÁøªËØë',
                        js: $.toString((title) => {
                            return "x5://https://www.deepl.com/zh/translator-mobile#cn/zh/" + title
                        }, title)
                    }, {
                        title: 'Ë∞∑Ê≠åÁøªËØë',
                        js: $.toString((title) => {
                            return "x5://https://translate.google.com/?hl=zh-CN&sl=cn&tl=zh-CN&text=" + title
                        }, title)
                    }]
                }
            })
        } catch {}
        const id = html.match(/ajaxid = "(.*?)"/)[1];
        const img = pdfh(html, "#rightcolumn&&#video_jacket_img&&src");
        // const preview = pdfh(html, "#pills-preview&&source&&src")
        Apollo.d.push({
            img: img,
            url: "hiker://empty"
                /* $('').lazyRule((id) => {
                    const Apollo = $.require('hiker://page/Apollo')
                    var result = JSON.parse(post(Apollo.url + "/acnx/acnx_get_play_sample.php", {
                        headers: {
                            "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                            "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                        },
                        body: {
                            vid: id,
                            action: "get",
                        }
                    }));
                    if (result.ERROR == 1) {
                        var html = result.videourl
                        var list = pdfa(html, "#samplevideo&&source")
                        let res = list.map(n => pdfh(n, "source&&res")).reverse()
                        let src = list.map(n => pdfh(n, "source&&src")).reverse()
                        let playlist = {
                            names: res,
                            urls: src
                        }
                        return playlist
                    } else {
                        return "toast://Ê≤°ÊúâÈ¢ÑËßàËßÜÈ¢ëÂì¶üòë"
                    }
                }, id)*/
                ,
            col_type: "pic_1_full",
        })

        Apollo.d.push({
            col_type: "big_blank_block"
        })
        const ËØÜÂà´Á†Å = pdfh(html, "#rightcolumn&&#video_id&&.text&&Text")
        Apollo.CodeParse(ËØÜÂà´Á†Å)

        try {
            var list = pdfa(html, "#rightcolumn&&.previewthumbs&&a[href^=http]")
            if (list.length > 0) {
                Apollo.d.push({
                    title: '‚Äú‚Äú‚Äù‚Äù' + ("ÁÇπÂáªÂ±ïÂºÄÂõæÁâá" + list.length + "Âº†")
                        .fontcolor("#FF00FF"),
                    url: Apollo.empty + $("")
                        .lazyRule((list) => {
                            try {
                                if (getMyVar("piclist", "Êî∂Ëµ∑") == "Êî∂Ëµ∑") {
                                    addItemAfter('picnum', {
                                        title: '‚Äú‚Äú‚Äù‚Äù' + "„ÄêÊî∂Ëµ∑ÂõæÁâá„Äë".fontcolor("#FF00FF"),
                                        url: "hiker://empty" + $("")
                                            .lazyRule((list) => {
                                                for (var i = list.length - 1; i >= 0; i--) {
                                                    deleteItem('previewpic' + i);
                                                }
                                                deleteItem('nopiclist');
                                                putMyVar("piclist", "Êî∂Ëµ∑");
                                                return "hiker://empty"
                                            }, list),
                                        col_type: "text_center_1",
                                        extra: {
                                            lineVisible: false,
                                            id: "nopiclist"
                                        }
                                    })
                                    for (var i = list.length - 1; i >= 0; i--) {
                                        addItemAfter('picnum', {
                                            url: 'hiker://empty',
                                            img: pdfh(list[i], "a&&href"),
                                            col_type: "pic_1_full",
                                            extra: {
                                                id: 'previewpic' + i
                                            }
                                        });
                                    }
                                    putMyVar("piclist", "Â±ïÂºÄ");
                                } else {
                                    for (var i = list.length - 1; i >= 0; i--) {
                                        deleteItem('previewpic' + i);
                                    }
                                    deleteItem('nopiclist');
                                    putMyVar("piclist", "Êî∂Ëµ∑");
                                }
                                return "hiker://empty"
                            } catch {
                                return "hiker://empty"
                            }
                        }, list),
                    col_type: "text_center_1",
                    extra: {
                        lineVisible: false,
                        id: "picnum"
                    }
                })
            } else {
                Apollo.d.push({
                    col_type: "big_blank_block"
                }, {
                    col_type: "big_blank_block"
                }, {
                    col_type: "big_blank_block"
                })
            }
        } catch {}

        var subscribed = pdfh(html, "#video_favorite_edit&&#subscribed&&.hidden&&Text")
        var watched = pdfh(html, "#video_favorite_edit&&#watched&&.hidden&&Text")
        var owned = pdfh(html, "#video_favorite_edit&&#owned&&.hidden&&Text")
        Apollo.d.push({
            title: '‚Äú‚Äú‚Äù‚ÄùÁï™Âè∑:' + ËØÜÂà´Á†Å.fontcolor("#FFD000"),
            url: "copy://" + ËØÜÂà´Á†Å,
            col_type: "scroll_button",
        }, {
            title: subscribed == "ÊàëÊÉ≥Ë¶Å" ? '‚Äú‚Äú‚Äù‚Äù' + "üíúÁæé‰π≥".fontcolor("#FF00FF") : '‚Äú‚Äú‚Äù‚Äù' + "‚úô".fontcolor("#FFD000") + "Áæé‰π≥",
            url: subscribed == "ÊàëÊÉ≥Ë¶Å" ? $('').lazyRule((id) => {
                const Apollo = $.require('hiker://page/Apollo')
                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_cv_favoriteremove.php", {
                    headers: {
                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                    },
                    body: {
                        targetid: id,
                        type: "3",
                    }
                })).ERROR;
                if (result == 1) {
                    back(true);
                    return "toast://Âà†Èô§Êî∂ËóèÊàêÂäüÔºÅ"
                } else if (result == 2) {
                    return "toast://ËØ∑ÂÖàÁôªÂΩïÔºÅ"
                } else {
                    return "toast://Âà†Èô§Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                }
            }, id) : $('').lazyRule((id) => {
                const Apollo = $.require('hiker://page/Apollo')
                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_cv_favoriteadd.php", {
                    headers: {
                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                    },
                    body: {
                        targetid: id,
                        type: "3",
                    }
                })).ERROR;
                //log(result)
                if (result == 1) {
                    refreshPage(false);
                    return "toast://Ê∑ªÂä†Êî∂ËóèÊàêÂäüÔºÅ"
                } else if (result == 2) {
                    return "toast://ËØ∑ÂÖàÁôªÂΩïÔºÅ"
                } else {
                    return "toast://Ê∑ªÂä†Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                }
            }, id),
            col_type: "scroll_button",
        }, {
            title: watched == "ÁúãËøá‰∫Ü" ? '‚Äú‚Äú‚Äù‚Äù' + "üíúÈï∑Ë∫´".fontcolor("#FF00FF") : '‚Äú‚Äú‚Äù‚Äù' + "‚úô".fontcolor("#FFD000") + "Èï∑Ë∫´",
            url: watched == "ÁúãËøá‰∫Ü" ? $('').lazyRule((id) => {
                const Apollo = $.require('hiker://page/Apollo')
                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_cv_favoriteremove.php", {
                    headers: {
                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                    },
                    body: {
                        targetid: id,
                        type: "1",
                    }
                })).ERROR;
                //log(result)
                if (result == 1) {
                    back(true);
                    return "toast://Âà†Èô§Êî∂ËóèÊàêÂäüÔºÅ"
                } else if (result == 2) {
                    return "toast://ËØ∑ÂÖàÁôªÂΩïÔºÅ"
                } else {
                    return "toast://Âà†Èô§Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                }
            }, id) : $('').lazyRule((id) => {
                const Apollo = $.require('hiker://page/Apollo')
                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_cv_favoriteadd.php", {
                    headers: {
                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                    },
                    body: {
                        targetid: id,
                        type: "1",
                    }
                })).ERROR;
                //log(result)
                if (result == 1) {
                    refreshPage(false);
                    return "toast://Ê∑ªÂä†Êî∂ËóèÊàêÂäüÔºÅ"
                } else if (result == 2) {
                    return "toast://ËØ∑ÂÖàÁôªÂΩïÔºÅ"
                } else {
                    return "toast://Ê∑ªÂä†Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                }
            }, id),
            col_type: "scroll_button",
        }, {
            title: owned == "Â∑≤Êã•Êúâ" ? '‚Äú‚Äú‚Äù‚Äù' + "üíúÁªù‰∏ñ".fontcolor("#FF00FF") : '‚Äú‚Äú‚Äù‚Äù' + "‚úô".fontcolor("#FFD000") + "Áªù‰∏ñ",
            url: owned == "Â∑≤Êã•Êúâ" ? $('').lazyRule((id) => {
                const Apollo = $.require('hiker://page/Apollo')
                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_cv_favoriteremove.php", {
                    headers: {
                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                    },
                    body: {
                        targetid: id,
                        type: "2",
                    }
                })).ERROR;
                if (result == 1) {
                    back(true);
                    return "toast://Âà†Èô§Êî∂ËóèÊàêÂäüÔºÅ"
                } else if (result == 2) {
                    return "toast://ËØ∑ÂÖàÁôªÂΩïÔºÅ"
                } else {
                    return "toast://Âà†Èô§Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                }
            }, id) : $('').lazyRule((id) => {
                const Apollo = $.require('hiker://page/Apollo')
                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_cv_favoriteadd.php", {
                    headers: {
                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                    },
                    body: {
                        targetid: id,
                        type: "2",
                    }
                })).ERROR;
                if (result == 1) {
                    refreshPage(false);
                    return "toast://Ê∑ªÂä†Êî∂ËóèÊàêÂäüÔºÅ"
                } else if (result == 2) {
                    return "toast://ËØ∑ÂÖàÁôªÂΩïÔºÅ"
                } else {
                    return "toast://Ê∑ªÂä†Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                }
            }, id),
            col_type: "scroll_button",
        }, {
            col_type: 'blank_block',
        }, {
            title: pdfh(html, '#rightcolumn&&#video_date&&Text'),
            url: Apollo.empty,
            col_type: "scroll_button",
        }, {
            title: pdfh(html, '#rightcolumn&&#video_length&&Text'),
            url: Apollo.empty,
            col_type: "scroll_button",
        }, {
            col_type: 'blank_block',
        })

        //ÊºîÂëò
        var arts = parseDomForArray(html, '#rightcolumn&&.cast');
        if (arts.length > 0) {
            Apollo.d.push({
                col_type: "blank_block"
            })
            Apollo.d.push({
                title: "ÊºîÂì° : ",
                url: 'hiker://empty',
                col_type: 'scroll_button',
            })
            for (var i in arts) {
                var title = parseDomForHtml(arts[i], 'a&&Text');
                var star_id = parseDomForHtml(arts[i], '.icn_favstar&&id').replace("star_", "");
                var url = pdfh(arts[i], 'a&&href');
                url = url.includes("cn") ? Apollo.url + url : Apollo.url + "/cn/" + url;
                Apollo.d.push({
                    title: '‚Äò‚Äò‚Äô‚Äô<b><middle><font color="#c13141">' + title + '</font></middle></b>',
                    url: url + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: title,
                        longClick: [{
                            title: '‚úúÊî∂ËóèÊºîÂëò',
                            js: $.toString((star_id) => {
                                const Apollo = $.require('hiker://page/Apollo')
                                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_favoriteadd_star.php", {
                                    headers: {
                                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                                    },
                                    body: {
                                        id: star_id,
                                        type: "4",
                                    }
                                })).ERROR;
                                if (result == 2) {
                                    return "toast://Êî∂ËóèÊºîÂëòÊàêÂäüÔºÅ"
                                } else {
                                    return "toast://Ê∑ªÂä†Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                                }
                            }, star_id)
                        }, {
                            title: 'Â§çÂà∂ÊºîÂëò',
                            js: $.toString((title) => {
                                return "copy://" + title;
                            }, title)
                        }, {
                            title: 'Ë∞∑Ê≠åÊêúÁ¥¢',
                            js: $.toString((title) => {
                                return "https://www.google.com/search?q=" + title;
                            }, title)
                        }, {
                            title: 'ÁôæÂ∫¶ÊêúÁ¥¢',
                            js: $.toString((title) => {
                                return "https://www.baidu.com/s?wd=" + title;
                            }, title)
                        }, {
                            title: 'Á£ÅÂäõÊêúÊºîÂëò',
                            js: $.toString((title) => {
                                return "hiker://page/sou?rule=Á£ÅÂäõÂêõ.ÁÆÄ&p=fypage&searchTerms=" + title
                            }, title)
                        }]
                    }
                })
            }
        }

        //Á±ªÂà´
        var arts = parseDomForArray(html, '#rightcolumn&&#video_genres&&a');
        if (arts.length > 0) {
            Apollo.d.push({
                col_type: "blank_block"
            })
            Apollo.d.push({
                title: "È°ûÂà• : ",
                url: 'hiker://empty',
                col_type: 'scroll_button',
            });
            for (var i in arts) {
                var url = pdfh(arts[i], 'a&&href');
                url = url.includes("cn") ? Apollo.url + url : Apollo.url + "/cn/" + url;
                Apollo.d.push({
                    title: '‚Äò‚Äò‚Äô‚Äô<b><middle><font color="#1E8884">' + parseDomForHtml(arts[i], 'Text') + '</font></middle></b>',
                    url: url + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: parseDomForHtml(arts[i], 'Text')
                    }
                })
            }
        }

        Apollo.d.push({
            col_type: "blank_block"
        })
        //ÂØºÊºî
        try {
            var director = pdfh(html, '#rightcolumn&&#video_director&&a&&Text');
            var director_id = pdfh(html, '#rightcolumn&&#video_director&&.icn_favdirector&&id').replace("director_", "");
            if (director) {
                Apollo.d.push({
                    title: "ÂØºÊºî : ",
                    url: 'hiker://empty',
                    col_type: 'scroll_button',
                })
                Apollo.d.push({
                    title: '‚Äò‚Äò‚Äô‚Äô<b><middle><font color="#1E90FF">' + director + '</font></middle></b>',
                    url: Apollo.url + "/cn/" + pdfh(html, '#rightcolumn&&#video_director&&a&&href') + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: director,
                        longClick: [{
                            title: '‚úúÊî∂ËóèÂØºÊºî',
                            js: $.toString((director_id) => {
                                const Apollo = $.require('hiker://page/Apollo')
                                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_favoriteadd_director.php", {
                                    headers: {
                                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                                    },
                                    body: {
                                        id: director_id,
                                        type: "5",
                                    }
                                })).ERROR;
                                if (result == 2) {
                                    return "toast://Êî∂ËóèÂØºÊºîÊàêÂäüÔºÅ"
                                } else if (result == 1) {
                                    return "toast://Â∑≤ÁªèÊî∂ËóèÊàêÂäüÔºÅ"
                                } else {
                                    return "toast://Ê∑ªÂä†Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                                }
                            }, director_id)
                        }]
                    }
                });
            }
        } catch {}
        //ÁâáÂïÜ
        try {
            var maker = pdfh(html, '#rightcolumn&&#video_maker&&a&&Text');
            var maker_id = pdfh(html, '#rightcolumn&&#video_maker&&.icn_favmaker&&id').replace("maker_", "");
            if (maker) {
                Apollo.d.push({
                    title: "ÁâáÂïÜ : ",
                    url: 'hiker://empty',
                    col_type: 'scroll_button',
                })
                Apollo.d.push({
                    title: '‚Äò‚Äò‚Äô‚Äô<b><middle><font color="#1E90FF">' + maker + '</font></middle></b>',
                    url: Apollo.url + "/cn/" + pdfh(html, '#rightcolumn&&#video_maker&&a&&href') + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: maker,
                        longClick: [{
                            title: '‚úúÊî∂ËóèÁâáÂïÜ',
                            js: $.toString((maker_id) => {
                                const Apollo = $.require('hiker://page/Apollo')
                                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_favoriteadd_maker.php", {
                                    headers: {
                                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                                    },
                                    body: {
                                        id: maker_id,
                                        type: "6",
                                    }
                                })).ERROR;
                                if (result == 2) {
                                    return "toast://Êî∂ËóèÁâáÂïÜÊàêÂäüÔºÅ"
                                } else if (result == 1) {
                                    return "toast://Â∑≤ÁªèÊî∂ËóèÊàêÂäüÔºÅ"
                                } else {
                                    return "toast://Ê∑ªÂä†Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                                }
                            }, maker_id)
                        }]
                    }
                })
            }
        } catch {}
        //ÂèëË°åÂïÜ
        try {
            var label = pdfh(html, '#rightcolumn&&#video_label&&a&&Text');
            var label_id = pdfh(html, '#rightcolumn&&#video_label&&.icn_favlabel&&id').replace("label_", "");
            if (label) {
                Apollo.d.push({
                    title: "ÂèëË°åÂïÜ : ",
                    url: 'hiker://empty',
                    col_type: 'scroll_button',
                })
                Apollo.d.push({
                    title: '‚Äò‚Äò‚Äô‚Äô<b><middle><font color="#1E90FF">' + label + '</font></middle></b>',
                    url: Apollo.url + "/cn/" + pdfh(html, '#rightcolumn&&#video_label&&a&&href') + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: label,
                        longClick: [{
                            title: '‚úúÊî∂ËóèÂèëË°å',
                            js: $.toString((label_id) => {
                                const Apollo = $.require('hiker://page/Apollo')
                                var result = JSON.parse(post(Apollo.url + "/ajax/ajax_favoriteadd_label.php", {
                                    headers: {
                                        "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                                        "User-Agent": "Mozilla/5.0 (Linux; Android 12; SM-G9750 Build/SP1A.210812.016; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/89.0.4389.72 MQQBrowser/6.2 TBS/046279 Mobile Safari/537.36",
                                    },
                                    body: {
                                        id: label_id,
                                        type: "7",
                                    }
                                })).ERROR;
                                if (result == 2) {
                                    return "toast://Êî∂ËóèÂèëË°åÊàêÂäüÔºÅ"
                                } else if (result == 1) {
                                    return "toast://Â∑≤ÁªèÊî∂ËóèÊàêÂäüÔºÅ"
                                } else {
                                    return "toast://Ê∑ªÂä†Êî∂ËóèÂ§±Ë¥•ÔºÅ"
                                }
                            }, label_id)
                        }]
                    }
                })
            }
        } catch {}
        Apollo.d.push({
            col_type: "blank_block"
        })

        Apollo.ReplysParse(html)
        Apollo.d.push({
            title: '‚Äú‚Äú‚Äù‚Äù' + "ÊàëÊòØÊúâÂ∫ïÁ∫øÁöÑ".fontcolor("grey")
                .small(),
            url: Apollo.empty,
            col_type: "text_center_1",
            extra: {
                lineVisible: false
            }
        })
        setResult(Apollo.d)
    },

    //ÂõûÂ§çÂàóË°®
    ReplysParse: (html) => {
        const replys = pdfa(html, 'body&&#rightcolumn&&table:has(.t):not(:matches(ÁÇπÂáª|ÈªûÊìä|ÂøÖ‰∏ã))');
        if (replys.length > 0) {
            Apollo.d.push({
                title: '‚Äú‚Äú‚Äù‚Äù' + "Áî®Êà∑ÂõûÂ§ç Ôºö".fontcolor("#FFD000").sub(),
                url: "https:" + pdfh(html, "link[rel=shortlink]&&href"),
                col_type: "text_1",
                extra: {
                    lineVisible: false
                }
            })
            replys.forEach(item => {
                var title = pdfh(item, ".t&&Text").replace(/\[.*?\]/g, "")
                var url = title.match(/(magnet:|https?:).*/) ? title.match(/(magnet:|https?:)[^\[\]\<\;\n]+/)[0] : "hiker://empty"
                Apollo.d.push({
                    title: url != "hiker://empty" ? '‚Äú‚Äú‚Äù‚Äù' + title.fontcolor("#67E0FA").small() : `&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;` + title.fontcolor("#8A2BE2").small(),
                    url: url,
                    col_type: url != "hiker://empty" ? "text_1" : "rich_text",
                    extra: {
                        lineVisible: false
                    }
                }, {
                    col_type: "line"
                })
            })
        }
    },

    //ÁøªËØë
    translate: (text) => {
        var switchtrans = true;
        if (switchtrans == true || switchtrans == "ÂΩ©‰∫ëÂ∞èËØë") {
            try {
                var to = 'zh'
                var from = 'auto'

                function init_data(source_lang, target_lang) {
                    return {
                        source: '',
                        detect: true,
                        os_type: 'ios',
                        device_id: 'F1F902F7-1780-4C88-848D-71F35D88A602',
                        trans_type: source_lang + '2' + target_lang,
                        media: 'text',
                        request_id: 424238335,
                        user_id: '',
                        dict: true,
                    }
                }

                function getRandomNumber() {
                    const rand = Math.floor(Math.random() * 99999) + 100000
                    return rand * 1000
                }
                const post_data = init_data(from, to)
                post_data.source = text
                post_data.request_id = getRandomNumber()
                let res = fetch('https://interpreter.cyapi.cn/v1/translator', {
                    method: 'POST',
                    header: {
                        'Content-Type': 'application/json',
                        'x-authorization': 'token ssdj273ksdiwi923bsd9',
                        'user-agent': 'caiyunInterpreter/5 CFNetwork/1404.0.5 Darwin/22.3.0',
                    },
                    body: post_data,
                })
                let result = JSON.parse(res)
                    .target
                return result + "„Äê‚òÅÔ∏è„Äë"
            } catch {
                log("ÁøªËØëÂ§±Ë¥•Ôºå‰ΩøÁî®ÂéüÊñá");
                return text
            }
        } else if (switchtrans == "Â∞èÁâõÁøªËØë") {
            try {
                var url = "https://api.niutrans.com/NiuTransServer/translation";
                var api = config.api;
                if (api) {
                    if (text != "") {
                        var lang = "https://test.niutrans.com/NiuTransServer/language?src_text=" + text + "&source=text";
                        var from = JSON.parse(fetch(lang, {
                                timeout: 1000
                            }))
                            .language;
                        var result = post(url, {
                            body: {
                                src_text: text,
                                from: from,
                                to: "zh",
                                apikey: api,
                            },
                            timeout: 1223
                        });
                        var data = JSON.parse(result)
                        if (data.tgt_text) {
                            return data.tgt_text + "„ÄêüêÆ„Äë"
                        } else {
                            log("ÁøªËØëÂ§±Ë¥•Ôºå‰ΩøÁî®ÂéüÊñá");
                            return text
                        }
                    } else {
                        log("ÁøªËØëÂ§±Ë¥•ÔºåÂéüÊñá‰∏∫Á©∫");
                        return text
                    }
                } else {
                    toast("È¢ÑÂ§ÑÁêÜËØ∑Â°´ÂÜôÁøªËØëapi")
                    return text
                }
            } catch {
                log("ÁøªËØëÂ§±Ë¥•Ôºå‰ΩøÁî®ÂéüÊñá");
                return text
            }
        } else {
            return text
        }
    },

    //Â§ñÈìæÊí≠Êîæ
    CodeParse: (ËØÜÂà´Á†Å) => {
        Apollo.d.push({
            col_type: 'blank_block',
        })
        var codelazy = fetch('hiker://files/rules/Apollo/ùêÇùê®ùêùùêûùêãùêöùê≥ùê≤.js')
            .replace(/d\.push/g, "Apollo.d.push") || "";

        function downcode() {
            var js = fetch("https://mirror.ghproxy.com/https://raw.githubusercontent.com/ApolloRioo/R/master/ùêÇùê®ùêùùêûùêãùêöùê≥ùê≤");
            writeFile('hiker://files/rules/Apollo/ùêÇùê®ùêùùêûùêãùêöùê≥ùê≤.js', js);
            toast("ËøúÁ®ãÊï∞ÊçÆÂ∑≤Êõ¥Êñ∞Âà∞Êú¨Âú∞")
            codelazy = fetch('hiker://files/rules/Apollo/ùêÇùê®ùêùùêûùêãùêöùê≥ùê≤.js')
                .replace(/d\.push/g, "Apollo.d.push")
        }
        if (!codelazy) {
            downcode()
        }
        try {
            eval(codelazy)
        } catch {
            downcode()
            eval(codelazy)
            log("ËØªÂèñÂ§±Ë¥•Êõ¥Êñ∞ËøúÁ®ãÊï∞ÊçÆ")
        }
        CodeLazy(ËØÜÂà´Á†Å)
    },

    HostParse: (url, html) => {
        if (!html && !url.includes("Ê≤°Êúâ‰∏ã‰∏ÄÈ°µÂì¶")) {
            var host = "https://www.javlibrary.com";
            confirm({
                title: 'Âõæ‰π¶È¶Ü',
                content: 'ËøêËê•ÂïÜÂ±èËîΩÔºåÂàáÊç¢Êµ∑Â§ñÂú∞ÂùÄ\n' + host,
                confirm: $.toString((host) => {
                    log("Êµ∑Â§ñÂú∞ÂùÄÔºö" + host);
                    setItem('link', host);
                    refreshPage()
                }, host),
                cancel: $.toString(() => {})
            })
        } else if (html.includes("Just a moment...") && url.includes("javlibrary.com")) {
            confirm({
                title: 'Âõæ‰π¶È¶Ü',
                content: 'Ëé∑ÂèñÂÖçÁøªÂú∞ÂùÄ\nÊàñËÄÖÈÄâÊã©ÂêàÈÄÇËäÇÁÇπ',
                confirm: $.toString(() => {
                    showLoading('Ê≠£Âú®Ëé∑ÂèñÂüüÂêçÔºåËØ∑Á®çÂÄô');
                    let host;
                    var homeLink = "https://github.com/javlibcom" //"https://javlib.com/";
                    var hhtml = fetch(homeLink, {
                        dns: 'https://dns.alidns.com/dns-query'
                    })
                    cnhost = pdfh(hhtml, ".vcard-details&&a&&href") //pdfh(hhtml, "body&&p:matches(ÁÆÄ‰Ωì‰∏≠Êñá)&&a&&href");
                    host = cnhost.replace(/\/cn.*/, '')
                    log("ÂÖçÁøªÂú∞ÂùÄÔºö" + host);
                    toast("ÂÖçÁøªÂú∞ÂùÄÔºö" + host)
                    setItem('link', host);
                    hideLoading();
                    refreshPage()
                }),
                cancel: $.toString(() => {})
            })
        } else if (html.includes("Just a moment...") && !url.includes("javlibrary.com")) {
            var host = "https://www.javlibrary.com";
            confirm({
                title: 'Âõæ‰π¶È¶Ü',
                content: 'Ë¢´CFÔºåÂàáÊç¢Êµ∑Â§ñÂú∞ÂùÄ\n' + host,
                confirm: $.toString((host) => {
                    log("Êµ∑Â§ñÂú∞ÂùÄÔºö" + host);
                    setItem('link', host);
                    refreshPage()
                }, host),
                cancel: $.toString(() => {})
            })
        }
    }

}

$.exports = Apollo