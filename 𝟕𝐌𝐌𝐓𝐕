const Apollo = {
    version: "20241206",
    empty: "hiker://empty",
    url: "https://7mmtv.sx/zh/",
    d: [],
    data: {
        category: getMyVar('Apo.category', '0'),
        subCate: getMyVar('Apo.subCate', '0'),
    },
    getRangeColors: function() {
        return '#' + ('00000' + (Math.random() * 0x1000000 << 0)
                .toString(16))
            .substr(-6);
    }, //éšæœºé¢œè‰²
    baseParse: () => {
        let categoryList = [{
            "title": "ä¸»é ",
            "path": "",
            "type": "home",
            "sub": []
        }, {
            "title": "ç„¡ç¢¼ç ´è§£",
            "path": "",
            "type": "video",
            "sub": [{
                "title": "ç„¡ç¢¼ç ´è§£",
                "path": "https://7mmtv.sx/zh/reducing-mosaic_list/all/1.html"
            }, {
                "title": "éš¨æ©Ÿç ´è§£",
                "path": "https://7mmtv.sx/zh/censored_random/all/index.html"
            }]
        }, {
            "title": "ä¸­å­—AV",
            "path": "",
            "type": "video",
            "sub": [{
                "title": "ä¸­å­— A V ",
                "path": "https://7mmtv.sx/zh/chinese_list/all/1.html"
            }, {
                "title": "éš¨æ©Ÿä¸­å­—",
                "path": "https://7mmtv.sx/zh/chinese_random/all/index.html"
            }]
        }, {
            "title": "æœ‰ç¢¼AV",
            "path": "",
            "type": "video",
            "sub": [{
                "title": "æœ‰ç¢¼ A V ",
                "path": "https://7mmtv.sx/zh/censored_list/all/1.html"
            }, {
                "title": "éš¨æ©Ÿæœ‰ç¢¼",
                "path": "https://7mmtv.sx/zh/censored_random/all/index.html"
            }, {
                "title": "é¡åˆ¥æ¸…å–®",
                "path": "https://7mmtv.sx/zh/censored_categorylist/list/index.html"
            }]
        }, {
            "title": "ç´ äººAV",
            "path": "",
            "type": "video",
            "sub": [{
                "title": "ç´ äºº A V ",
                "path": "https://7mmtv.sx/zh/amateurjav_list/all/1.html"
            }, {
                "title": "éš¨æ©Ÿç´ äºº",
                "path": "https://7mmtv.sx/zh/amateurjav_random/all/index.html"
            }, {
                "title": "é¡åˆ¥æ¸…å–®",
                "path": "https://7mmtv.sx/zh/amateurjav_categorylist/list/index.html"
            }, {
                "title": "ã‚·ãƒ­ã‚¦ãƒˆT",
                "path": "https://7mmtv.sx/zh/amateurjav_makersr/1752/ã‚·ãƒ­ã‚¦ãƒˆTV(SIRO)/1.html"
            }, {
                "title": "ãƒ©ã‚°ã‚¸ãƒ¥T",
                "path": "https://7mmtv.sx/zh/amateurjav_makersr/1586/ãƒ©ã‚°ã‚¸ãƒ¥TV(LUXU)/1.html"
            }, {
                "title": "ãƒŠãƒ³ãƒ‘T",
                "path": "https://7mmtv.sx/zh/amateurjav_makersr/1751/ãƒŠãƒ³ãƒ‘TV(200GANA)/1.html"
            }, {
                "title": "PRESTIGE PREMIU",
                "path": "https://7mmtv.sx/zh/amateurjav_makersr/1318/PRESTIGE PREMIUM(300MAAN)/1.html"
            }, {
                "title": "S-CUTE",
                "path": "https://7mmtv.sx/zh/amateurjav_makersr/1069/S-CUTE/1.html"
            }, {
                "title": "ARA",
                "path": "https://7mmtv.sx/zh/amateurjav_makersr/1585/ARA/1.html"
            }]
        }, {
            "title": "ç„¡ç¢¼AV",
            "path": "",
            "type": "video",
            "sub": [{
                "title": "ç„¡ç¢¼ A V ",
                "path": "https://7mmtv.sx/zh/uncensored_list/all/1.html"
            }, {
                "title": "éš¨æ©Ÿç„¡ç¢¼",
                "path": "https://7mmtv.sx/zh/uncensored_random/all/index.html"
            }, {
                "title": "FC2",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/37/FC2/1.html"
            }, {
                "title": "HEYZO",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/17/HEYZO/1.html"
            }, {
                "title": "æ±äº¬",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/29/æ±äº¬ç†±(Tokyo Hot)/1.html"
            }, {
                "title": "ä¸€æœ¬",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/32/ä¸€æœ¬é“(1pondo)/1.html"
            }, {
                "title": "ã‚«ãƒªãƒ“ã‚¢ãƒ³ã‚³",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/30/ã‚«ãƒªãƒ“ã‚¢ãƒ³ã‚³ãƒ (Caribbeancom)/1.html"
            }, {
                "title": "ã‚«ãƒªãƒ“ã‚¢ãƒ³ã‚³ãƒ  PP",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/40/ã‚«ãƒªãƒ“ã‚¢ãƒ³ã‚³ãƒ PPV(Caribbeancompr)/1.html"
            }, {
                "title": "å¤©ç„¶ã‚€ã™",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/31/å¤©ç„¶ã‚€ã™ã‚(10musume)/1.html"
            }, {
                "title": "ãƒ‘ã‚³ãƒ‘ã‚³ãƒ",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/36/ãƒ‘ã‚³ãƒ‘ã‚³ãƒãƒ(pacopacomama)/1.html"
            }, {
                "title": "ã‚¬ãƒã‚“å¨˜",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/35/ã‚¬ãƒã‚“å¨˜ï¼(Gachinco)/1.html"
            }, {
                "title": "ã‚¨ãƒƒãƒãª4610",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/34/ã‚¨ãƒƒãƒãª4610/1.html"
            }, {
                "title": "äººå¦»æ–¬ã‚Š0930",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/38/äººå¦»æ–¬ã‚Š0930/1.html"
            }, {
                "title": "ã‚¨ãƒƒãƒãª0930",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/39/ã‚¨ãƒƒãƒãª0930/1.html"
            }, {
                "title": "ãƒˆãƒªãƒ—ãƒ«ã‚¨ãƒƒã‚¯ã‚¹",
                "path": "https://7mmtv.sx/zh/uncensored_makersr/126/ãƒˆãƒªãƒ—ãƒ«ã‚¨ãƒƒã‚¯ã‚¹ (XXX-AV)/1.html"
            }]
        }, {
            "title": "åœ‹ç”¢å½±ç‰‡",
            "path": "",
            "type": "video",
            "sub": [{
                "title": "åœ‹ç”¢å½±ç‰‡",
                "path": "https://7mmtv.sx/zh/amateur_list/all/1.html"
            }, {
                "title": "éš¨æ©Ÿåœ‹ç”¢",
                "path": "https://7mmtv.sx/zh/uncensored_random/all/index.html"
            }]
        }, {
            "title": "Hæ¼«ç•«è²¼åœ–",
            "path": "",
            "type": "video",
            "sub": [{
                "title": "Hæ¼«ç•«è²¼åœ–",
                "path": "https://7mmtv.sx/zh/hcomic_list/all/1.html"
            }, {
                "title": "çŸ­ç¯‡&åŒäºº",
                "path": "https://7mmtv.sx/zh/hcomic_list/short/1.html"
            }, {
                "title": "ä¸­ç¯‡",
                "path": "https://7mmtv.sx/zh/hcomic_list/novellas/1.html"
            }, {
                "title": "å–®è¡Œæœ¬",
                "path": "https://7mmtv.sx/zh/hcomic_list/voluminous/1.html"
            }, {
                "title": "éš¨æ©ŸHæ¼«ç•«",
                "path": "https://7mmtv.sx/zh/hcomic_random/all/index.html"
            }, {
                "title": "éš¨æ©ŸçŸ­ç¯‡&åŒäºº",
                "path": "https://7mmtv.sx/zh/hcomic_random/short/index.html"
            }, {
                "title": "éš¨æ©Ÿä¸­ç¯‡",
                "path": "https://7mmtv.sx/zh/hcomic_random/novellas/index.html"
            }, {
                "title": "éš¨æ©Ÿå–®è¡Œæœ¬",
                "path": "https://7mmtv.sx/zh/hcomic_random/voluminous/index.html"
            }]
        }]
        const currentCate = categoryList[Apollo.data.category]
        let url
        let type = currentCate.type
        let path = currentCate.path
        if (currentCate.sub.length > 0) {
            url = Apollo.url + getMyVar("url", currentCate.sub[Apollo.data.subCate].path)
            path = currentCate.sub[Apollo.data.subCate].path
        } else {
            url = Apollo.url + getMyVar("url", currentCate.path)
        }
        url = url.replace(/https?.*(https?.*)/, "$1")
        if (MY_PAGE === 1) {
            categoryList.forEach((cate, index) => {
                Apollo.d.push({
                    title: parseInt(Apollo.data.category) === index ? 'â€œâ€œâ€â€' + cate.title.fontcolor(Apollo.getRangeColors()) : cate.title,
                    url: $(Apollo.empty + "#noLoading#")
                        .lazyRule((index) => {
                            putMyVar("Apo.category", index.toString())
                            putMyVar("Apo.subCate", '0')
                            clearMyVar("url")
                            clearMyVar("sort")
                            clearMyVar("yurl");
                            refreshPage(true)
                            return "hiker://empty"
                        }, index),
                    col_type: 'scroll_button',
                })
            })
            if (currentCate.sub.length > 0) {
                Apollo.d.push({
                    col_type: 'blank_block',
                })
                currentCate.sub.forEach((cate, index) => {
                    Apollo.d.push({
                        title: parseInt(Apollo.data.subCate) === index ? 'â€œâ€œâ€â€' + cate.title.fontcolor(Apollo.getRangeColors()) : cate.title,
                        url: $(Apollo.empty + "#noLoading#")
                            .lazyRule((index) => {
                                putMyVar("Apo.subCate", index.toString())
                                clearMyVar("url")
                                clearMyVar("sort")
                                clearMyVar("yurl");
                                refreshPage(true)
                                return "hiker://empty"
                            }, index),
                        col_type: 'scroll_button',
                    })
                })
            }
        }
        if (MY_PAGE == 1 && !/category/.test(url)) {
            Apollo.d.push({
                title: "ğŸ”",
                url: $.toString(() => {
                    putMyVar('keyword', input);
                    var searchUrl = "https://7mmtv.sx/zh/searchall_search/all/" + input + "/1.html"
                    putMyVar("url", searchUrl);
                    refreshPage();
                    return "hiker://empty"
                }),
                desc: 'æœç´¢...',
                col_type: "input",
                extra: {
                    defaultValue: getMyVar('keyword', '') || "",
                }
            });
        }
        //ç¿»é¡µ
        /*
        if (MY_PAGE !== 1) {
            url = url.includes("?") ? url + "&page=" + MY_PAGE : url + "?&page=" + MY_PAGE
        }
        const html = fetch(url, {
            headers: {
                "Cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Windows NT 10.0)",
            }
        })*/
        let nextPage = getMyVar("nextPage", "");
        if (nextPage && MY_PAGE > 1) {
            if (url.includes("random")) {
                url = url
            } else {
                url = nextPage;
            }
        } else if (MY_PAGE > 1) {
            url = "æ²¡æœ‰ä¸‹ä¸€é¡µå“¦ğŸ˜‘"
        }
        const html = fetch(url, {
            headers: {
                //"cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "user-agent": "Mozilla/5.0 (Windows NT 10.0)"
            }
        })
        log(url)
        try {
            var next = pdfh(html, "body&&.pagination-row&&.previous-next:matches(>)&&a&&href")
            putMyVar("nextPage", next);
        } catch {
            clearMyVar("nextPage");
            //log("å¯èƒ½ä¸å­˜åœ¨ä¸‹ä¸€é¡µæˆ–è€…ä¸‹ä¸€é¡µå®šä½æœ‰é—®é¢˜");
        }

        if (url.includes("searchbyid")) {
            Apollo.d.push({
                title: 'â€œâ€œâ€â€' + "è¯†åˆ«ç æœå¯»ç»“æœ".fontcolor("#67E0FA"),
                url: "hiker://empty",
                col_type: "text_1",
                extra: {
                    lineVisible: false
                }
            })
        }

        switch (type) {
            case 'video':
                if (url.includes("categorylist")) {
                    Apollo.seriesType(url, html)
                } else {
                    Apollo.videoType(url, html)
                }
                break
            case 'home':
                Apollo.homeType(html)
                break
            case 'series':
                Apollo.seriesType(html)
                break
            default:
                Apollo.videoType(url, html)
        }
        setResult(Apollo.d)
    },
    //é¦–é¡µ
    homeType: (html) => {
        var tabs = pdfa(html, "body&&.block")
        tabs.forEach(tag => {
            let list = pdfa(tag, "body&&.video")
            Apollo.d.push({
                title: pdfh(tag, "h2&&Text").fontcolor("#FF00FF"),
                url: "hiker://empty",
                col_type: "rich_text",
            })
            list.forEach(item => {
                var url = pdfh(item, 'a&&href');
                var preview = pdfh(item, "video&&data-src");
                Apollo.d.push({
                    title: pdfh(item, "h3&&a&&Text"),
                    desc: pdfh(item, ".small&&Text"),
                    img: pdfh(item, "img&&data-src").replace(/\/m\//, "/b/").replace(/\/s\//, "/b/").replace(/hcomic\/b\//, "hcomic/s/"),
                    url: url + $('#noHistory#').rule(() => {
                        const Apollo = $.require('hiker://page/Apollo')
                        Apollo.videoParse(MY_URL)
                        setResult(Apollo.d)
                    }),
                    col_type: "movie_2",
                    extra: {
                        pageTitle: pdfh(item, "h3&&a&&Text"),
                        longClick: [{
                            title: "ã€10ç§’é¢„è§ˆã€‘",
                            js: $.toString((preview) => {
                                return preview
                            }, preview)
                        }]
                    }
                })
            })
            Apollo.d.push({
                col_type: "blank_block"
            })
        })
    },
    //ä¸€çº§è§†é¢‘åˆ—è¡¨
    videoType: (url, html) => {
        if (url.includes("hcomic_") && !url.includes("_content")) {
            col = "movie_3";
        } else {
            col = "movie_2";
        }
        lazy = $('#noHistory#')
            .rule(() => {
                const Apollo = $.require('hiker://page/Apollo?rule=ğŸ•ğŒğŒğ“ğ•')
                Apollo.videoParse(MY_URL)
                setResult(Apollo.d)
            })
        lazy1 = $('#noHistory#')
            .lazyRule(() => {
                var html = fetch(input)
                var script = pdfh(html, "body&&script[language]&&Html").split("i=")[0]
                eval(script)
                var pics = Large_cgurl.join("&&")
                return "pics://" + pics
            })
        try {
            var currpagenum = pdfh(html, "body&&.pagination-row&&.current&&Text")
        } catch {
            var currpagenum = "1"
        }
        try {
            if (currpagenum.includes("éš¨æ©Ÿ")) {
                var lastpagenum = 1
            } else {
                var lastpagenum = pdfh(html, "body&&.pagination-row&&.previous-next:matches(>)+li&&a&&Text");
                if (lastpagenum == "") {
                    lastpagenum = pdfh(html, "body&&.pagination-row&&li:nth-last-child(2)&&Text")
                }
                if (lastpagenum == ">") {
                    lastpagenum = pdfh(html, "body&&.pagination-row&&li:nth-last-child(3)&&Text")
                }
            }
        } catch {
            var lastpagenum = currpagenum
        }
        var list = pdfa(html, "body&&.video||.comics");
        list.forEach(item => {
            var vurl = pdfh(item, 'a&&href');
            var preview = pdfh(item, "video&&data-src");
            Apollo.d.push({
                title: pdfh(item, "h3&&a&&Text"),
                desc: pdfh(item, ".small&&Text"),
                img: pdfh(item, "img&&data-src").replace(/\/m\//, "/b/").replace(/\/s\//, "/b/").replace(/hcomic\/b\//, "hcomic/s/"),
                url: !vurl.includes("hcomic_") ? vurl + lazy : vurl + lazy1,
                col_type: col,
                extra: {
                    pageTitle: pdfh(item, "h3&&a&&Text"),
                    longClick: !url.includes("content") ? [{
                        title: "ã€10ç§’é¢„è§ˆã€‘",
                        js: $.toString((preview) => {
                            return preview
                        }, preview)
                    }, {
                        title: 'ã€è·³é¡µã€‘ã€' + currpagenum + '<=>' + lastpagenum + 'ã€‘',
                        js: $.toString((lastpagenum, url) => {
                                return $('', 'æ­£ç¡®çš„é¡µç ï¼š1=>' + lastpagenum + "é¡µ")
                                    .input((url, lastpagenum) => {
                                            if (input > 0 && input % 1 == 0 && input <= parseInt(lastpagenum)) {
                                                var jumpu = url.replace(/\d+\.html/, input + ".html")
                                                putMyVar("url", jumpu);
                                                putMyVar("yurl", jumpu);
                                                refreshPage();
                                                return 'toast://ä½ å·²ç»ç©¿è¶Šåˆ°äº†' + input + 'é¡µ'
                                            } else {
                                                return "toast://è¯·è¾“å…¥æ­£ç¡®çš„é¡µç "
                                            }
                                        },
                                        url, lastpagenum)
                            },
                            lastpagenum, url)
                    }] : [{
                        title: "ã€10ç§’é¢„è§ˆã€‘",
                        js: $.toString((preview) => {
                            return preview
                        }, preview)
                    }]
                }
            })
        })
    },

    //ä¸€çº§ç³»åˆ—
    seriesType: (url, html) => {
        if (MY_PAGE == 1) {
            Apollo.videoSort(html)
        }
        Apollo.videoType(url, html)
    },

    //ä¸€çº§sort
    videoSort: (html) => {
        Apollo.d.push({
            col_type: "blank_block",
        })
        var chtml = fetch("https://18av.mm-cg.com/zh/chinese_categorylist/list/index.html")
        const sort = pdfa(chtml, 'body&&.posts&&.post')
        sort.forEach((item, index) => {
            var title = pdfh(item, 'Text');
            Apollo.d.push({
                title: getMyVar('sort', '0') == index ? 'â€˜â€˜â€™â€™<strong><font color="#ff1493">' + title + '</font></strong>' : title,
                url: pdfh(item, 'a&&href') + $('#noLoading#')
                    .lazyRule((index) => {
                        putMyVar('sort', index);
                        putMyVar("url", input);
                        refreshPage();
                        return 'hiker://empty'
                    }, index),
                col_type: 'scroll_button'
            })
            if (index == 54 || index == 123 || index == 189 || index == 294) {
                Apollo.d.push({
                    col_type: "blank_block",
                })
            }
        })
    },
    //ä¸€çº§é¡µé¢.ç®€
    avatarParse: (url) => {
        addListener("onClose", $.toString(() => {
            clearMyVar("yurl");
            clearMyVar("ysort");
            clearMyVar("nextPage1");
        }));
        url = url.replace(/(.*?)#.*/, "$1");
        url = getMyVar("yurl", url)
            .replace(/(.*?)#.*/, "$1");
        /*
        if (MY_PAGE !== 1) {
            url = url.includes("?") ? url + "&page=" + MY_PAGE : url + "?&page=" + MY_PAGE
        }
        const html = fetch(url, {
            headers: {
                "Cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Windows NT 10.0)",
            }
        })
        log(url)*/
        let nextPage = getMyVar("nextPage1", "");
        if (nextPage && MY_PAGE > 1) {
            url = nextPage;
        } else if (MY_PAGE > 1) {
            url = "æ²¡æœ‰ä¸‹ä¸€é¡µå“¦ğŸ˜‘"
        }
        var html = fetch(url, {
            headers: {
                //"cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Windows NT 10.0)",
            }
        })
        log(url)
        try {
            var next = pdfh(html, "body&&.pagination-row&&.previous-next:matches(>)&&a&&href")
            putMyVar("nextPage1", next);
        } catch {
            clearMyVar("nextPage1");
            // log("å¯èƒ½ä¸å­˜åœ¨ä¸‹ä¸€é¡µæˆ–è€…ä¸‹ä¸€é¡µå®šä½æœ‰é—®é¢˜");
        }
        Apollo.videoType(url, html)
    },

    //æœç´¢
    searchParse: (url) => {
        url = url.replace("hiker://empty##", "")
        log(url)
        var html = fetch(url, {
            headers: {
                // "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Windows NT 10.0)",
            },
        });
        Apollo.videoType(url, html)
        setResult(Apollo.d)
    },

    //äºŒçº§
    videoParse: (url) => {
        addListener("onClose", () => {
            clearMyVar("piclist");
        });
        log(url)
        var yiji = $('#fypage#noHistory#')
            .rule(() => {
                const Apollo = $.require('hiker://page/Apollo?rule=ğŸ•ğŒğŒğ“ğ•')
                Apollo.avatarParse(MY_URL)
                setResult(Apollo.d)
            })
        const html = fetch(url, {
            headers: {
                // "cookie": fetchPC('hiker://files/rules/Apollo/Cookie/javlibrary_cookie.txt') || '',
                "User-Agent": "Mozilla/5.0 (Windows NT 10.0)",
            }
        })
        try {
            var title = pdfh(html, "h1&&Text")
                .replace("å…è´¹AVåœ¨çº¿çœ‹", "");
            Apollo.d.push({
                title: 'â€œâ€œâ€â€' + title.fontcolor("#E57A1A").small(),
                url: url,
                col_type: 'text_1',
                extra: {
                    lineVisible: false,
                    id: 'transdesc',
                    longClick: [{
                        title: 'å¤åˆ¶',
                        js: $.toString((title) => {
                            return "copy://" + title;
                        }, title)
                    }, {
                        title: 'ç™¾åº¦ç¿»è¯‘',
                        js: $.toString((title) => {
                            return "x5://https://fanyi.baidu.com/#jp/zh/" + title
                        }, title)
                    }, {
                        title: 'Deeplç¿»è¯‘',
                        js: $.toString((title) => {
                            return "x5://https://www.deepl.com/zh/translator-mobile#cn/zh/" + title
                        }, title)
                    }, {
                        title: 'è°·æ­Œç¿»è¯‘',
                        js: $.toString((title) => {
                            return "x5://https://translate.google.com/?hl=zh-CN&sl=cn&tl=zh-CN&text=" + title
                        }, title)
                    }]
                }
            })
        } catch {}

        try {
            const img = pdfh(html, ".content_main_cover&&img&&src").replace("/b/264938_ADN-308.jpg", "/m_webp/264938_ADN-308.webp");
            var prevideo = html.match(/source src='(.*?)'/) ? html.match(/source src='(.*?)'/)[1] : "toast://æ­¤å½±ç‰‡æ²’æœ‰è¦–é »é è¦½å“¦ğŸ˜";
            Apollo.d.push({
                img: img,
                url: prevideo,
                col_type: "pic_1_full",
            })
        } catch {}

        try {
            var fullvideo_showcg = pdfa(html, "#fullvideo_showallcg&&img").map(p => pdfh(p, "img&&data-src"))
            var allcgscript = pdfh(html, "body&&#fullvideo_showallcg+script&&Html").replace("new Array()", "fullvideo_showcg").split("fullvideo_showallcg_x")[0]
            eval(allcgscript)
            // log(fullvideo_showallcg_arr)
        } catch {}

        var lazypic = $('#noLoading#').lazyRule((fullvideo_showallcg_arr) => {
            if (fullvideo_showallcg_arr.length > 0) {
                return "pics://" + fullvideo_showallcg_arr.join("&&")
            } else {
                return "toast://æ­¤å½±ç‰‡æ²’æœ‰åœ–ç‰‡é è¦½å“¦ğŸ˜‘"
            }
        }, fullvideo_showallcg_arr)

        try {
            var content = pdfh(html, ".video-introduction-images-text&&Text")
            Apollo.d.push({
                title: "<a style='text-decoration: none;fontcolor:red;' href='" + lazypic + "'>é è¦½å’Œä»‹ç´¹</a>ï¼š" + (content != "" ? content : "æ›¾ç»æ²§æµ·éš¾ä¸ºæ°´ï¼Œé™¤å´å·«å±±ä¸æ˜¯äº‘ã€‚å–æ¬¡èŠ±ä¸›æ‡’å›é¡¾ï¼ŒåŠç¼˜ä¿®é“åŠç¼˜å›ã€‚\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t------å…ƒç¨¹").fontcolor("grey").small(),
                url: Apollo.empty,
                col_type: "rich_text",
                extra: {
                    lineVisible: false
                }
            })
        } catch {}

        Apollo.PlayParse(html)
        /*
        Apollo.d.push({
            col_type: "big_blank_block"
        })
*/
        try {
            const è¯†åˆ«ç  = pdfh(html, "body&&.fullvideo-details&&.me-3&&Text")
            if (è¯†åˆ«ç  != "") Apollo.CodeParse(è¯†åˆ«ç )
        } catch {}
        Apollo.d.push({
            col_type: "big_blank_block"
        })
        Apollo.d.push({
            col_type: "big_blank_block"
        })
        try {
            Apollo.d.push({
                title: 'â€œâ€œâ€â€ç•ªå·:' + è¯†åˆ«ç .fontcolor("#FFD000"),
                url: "copy://" + è¯†åˆ«ç ,
                col_type: "scroll_button",
            }, {
                title: "â€œâ€œâ€â€" + pdfh(html, 'body&&.fullvideo-details&&.me-3,1&&Text').fontcolor("#FB0086"),
                url: è¯†åˆ«ç  + $('#noLoading#')
                    .lazyRule(() => {
                        return "hiker://page/yj?rule=ğ‰ğšğ¯ğƒğ&url=" + getPublicItem('javdb0', 'https://javdb.com') + "/searchï¼Ÿï¼Ÿf=allï¼†ï¼†page=fypageï¼†ï¼†q=" + input
                    }),
                col_type: "scroll_button",
            }, {
                title: pdfh(html, 'body&&.fullvideo-details&&.me-3,2&&Text').replace(/ï¼ˆ.*?ï¼‰/, "é˜"),
                url: Apollo.empty,
                col_type: "scroll_button",
            }, {
                col_type: 'blank_block',
            })
        } catch {}
        //å¯¼æ¼”
        try {
            var director = pdfh(html, 'body&&.fullvideo-details&&.g-1:matches(å°æ¼”:)&&a&&Text');
            if (director) {
                Apollo.d.push({
                    title: "å¯¼æ¼”:",
                    url: 'hiker://empty',
                    col_type: 'scroll_button',
                })
                Apollo.d.push({
                    title: 'â€˜â€˜â€™â€™<b><middle><font color="#1E90FF">' + director + '</font></middle></b>',
                    url: pdfh(html, 'body&&.fullvideo-details&&.g-1:matches(å°æ¼”:)&&a&&href') + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: director,
                    }
                });
            }
        } catch {}
        //å‘è¡Œå•†
        try {
            var label = pdfh(html, 'body&&.fullvideo-details&&.g-1:matches(ç™¼è¡Œå•†:)&&a&&Text');
            if (label) {
                Apollo.d.push({
                    title: "å‘è¡Œå•†:",
                    url: 'hiker://empty',
                    col_type: 'scroll_button',
                })
                Apollo.d.push({
                    title: 'â€˜â€˜â€™â€™<b><middle><font color="#1E90FF">' + label + '</font></middle></b>',
                    url: pdfh(html, 'body&&.fullvideo-details&&.g-1:matches(ç™¼è¡Œå•†:)&&a&&href') + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: label,
                    }
                })
            }
        } catch {}
        //ç‰‡å•†
        try {
            var maker = pdfh(html, 'body&&.fullvideo-details&&.g-1:matches(è£½ä½œå•†:)&&a&&Text');
            if (maker) {
                Apollo.d.push({
                    title: "ç‰‡å•†:",
                    url: 'hiker://empty',
                    col_type: 'scroll_button',
                })
                Apollo.d.push({
                    title: 'â€˜â€˜â€™â€™<b><middle><font color="#1E90FF">' + maker + '</font></middle></b>',
                    url: pdfh(html, 'body&&.fullvideo-details&&.g-1:matches(è£½ä½œå•†:)&&a&&href') + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: maker,
                    }
                })
            }
        } catch {}

        Apollo.d.push({
            col_type: "blank_block"
        })

        //ç±»åˆ«
        var arts = parseDomForArray(html, 'body&&.fullvideo-details&&.categories&&a');
        if (arts.length > 0) {
            Apollo.d.push({
                col_type: "blank_block"
            })
            Apollo.d.push({
                title: "é¡åˆ¥:",
                url: 'hiker://empty',
                col_type: 'scroll_button',
            });
            for (var i in arts) {
                var urll = pdfh(arts[i], 'a&&href');
                Apollo.d.push({
                    title: 'â€˜â€˜â€™â€™<b><middle><font color="#1E8884">' + parseDomForHtml(arts[i], 'Text') + '</font></middle></b>',
                    url: urll + yiji,
                    col_type: 'scroll_button',
                    extra: {
                        pageTitle: parseDomForHtml(arts[i], 'Text')
                    }
                })
            }
        }

        //æ¼”å‘˜
        var arts = parseDomForArray(html, 'body&&.fullvideo-details&&.fullvideo-idol');
        if (arts.length > 0) {
            Apollo.d.push({
                col_type: "blank_block"
            })
            Apollo.d.push({
                title: "æ¼”å“¡ ",
                url: 'hiker://empty',
                col_type: 'text_center_1',
                extra: {
                    lineVisible: false
                }
            })
            for (var i in arts) {
                var title = parseDomForHtml(arts[i], 'Text');
                var urll = pdfh(arts[i], 'a&&href');
                Apollo.d.push({
                    title: 'â€˜â€˜â€™â€™<b><middle><font color="#c13141">' + title + '</font></middle></b>',
                    img: pdfh(arts[i], 'img&&data-src') ? pdfh(arts[i], 'img&&data-src') : "https://thumbsnap.com/i/sySMQ7Mg.jpg",
                    url: urll + yiji,
                    col_type: 'card_pic_3',
                    extra: {
                        pageTitle: title,
                        longClick: [{
                            title: 'å¤åˆ¶æ¼”å‘˜',
                            js: $.toString((title) => {
                                return "copy://" + title;
                            }, title)
                        }, {
                            title: 'è°·æ­Œæœç´¢',
                            js: $.toString((title) => {
                                return "https://www.google.com/search?q=" + title;
                            }, title)
                        }, {
                            title: 'ç™¾åº¦æœç´¢',
                            js: $.toString((title) => {
                                return "https://www.baidu.com/s?wd=" + title;
                            }, title)
                        }, {
                            title: 'ç£åŠ›æœæ¼”å‘˜',
                            js: $.toString((title) => {
                                return "hiker://page/sou?rule=ç£åŠ›å›.ç®€&p=fypage&searchTerms=" + title
                            }, title)
                        }]
                    }
                })
            }
        }
        Apollo.d.push({
            col_type: "blank_block"
        })

        Apollo.d.push({
            title: 'â€œâ€œâ€â€' + "éš¨æ©Ÿä¸»é¡Œ".fontcolor("#FF00FF"),
            url: Apollo.empty,
            col_type: "text_center_1",
            extra: {
                lineVisible: false
            }
        })
        Apollo.videoType(url, html)

        Apollo.d.push({
            title: 'â€œâ€œâ€â€' + "æˆ‘æ˜¯æœ‰åº•çº¿çš„".fontcolor("grey")
                .small(),
            url: Apollo.empty,
            col_type: "text_center_1",
            extra: {
                lineVisible: false
            }
        })
        setResult(Apollo.d)
    },

    //æ’­æ”¾åˆ—è¡¨
    PlayParse: (html) => {
        // å¼•å…¥åŠ å¯†è§£å¯†åº“
        eval(getCryptoJS())
        let list = [];
        let _hcdeedg252 = html.match(/hcdeedg252=\d+/)[0];
        let _hadeedg252 = html.match(/hadeedg252=\d+/)[0];
        // console.log(`_hcdeedg252:${_hcdeedg252}`);
        // console.log(`_hadeedg252:${_hadeedg252}`);
        let _argdeqweqweqwe = html.match(/.argdeqweqweqwe.=.'\w+';/)[0];
        // console.log(`_argdeqweqweqwe:${_argdeqweqweqwe}`);
        let _hdddedg252 = html.match(/.hdddedg252.=.'\w+';/)[0];
        // console.log(`_hdddedg252:${_hdddedg252}`);
        let _mvarr = html.match(/mvarr[\d_\[\]']+=\[\[.*\],\];/)[0];
        // console.log(_mvarr);
        let server = _mvarr.match(/mvarr[\d_\[\]']+/g).map(x => {
            return x.replace('mvarr[\'', '').replace('\']', '');
        });
        let mvarr = {};
        let hcdeedg252;
        let hadeedg252;
        let argdeqweqweqwe;
        let hdddedg252;
        let _js = `${_hcdeedg252},${_hadeedg252};${_argdeqweqweqwe}${_hdddedg252}${_mvarr}`;
        // console.log(_js);
        eval(_js);

        function hsdfdg252(a) {
            let hsddfdg252 = [];
            let hedeedg252 = [];
            hcdeedg252 = hcdeedg252 <= 25 ? hcdeedg252 : hcdeedg252 % 25;
            let splitStr = String.fromCharCode(hcdeedg252 + 97);
            hsddfdg252 = a.split(splitStr);
            for (let i = 0; i < hsddfdg252.length; i++) {
                let hfdeedg252 = parseInt(hsddfdg252[i], hcdeedg252);
                hfdeedg252 = (hfdeedg252 * 1) ^ hadeedg252;
                let hjdeedg252 = String.fromCharCode(hfdeedg252);
                hedeedg252.push(hjdeedg252)
            }
            let hgdeedg252 = hedeedg252.join("");
            return hgdeedg252
        }

        function decr_sun(a, b, c, d) {
            a = hsdfdg252(a);
            var e = CryptoJS.enc.Utf8.parse(argdeqweqweqwe);
            var f = CryptoJS.enc.Utf8.parse(hdddedg252);
            var g = CryptoJS.AES.decrypt(a, e, {
                iv: f,
                padding: CryptoJS.pad.Pkcs7
            });
            // console.log(b + g.toString(CryptoJS.enc.Utf8) + c);
            return b + g.toString(CryptoJS.enc.Utf8) + c;
            // $("#" + d).attr("src", b + g.toString(CryptoJS.enc.Utf8) + c)
        }

        function jfun_show_mvinnerHTML(a) {
            if (a === '7_1' || a === '28_1') {
                //return;
            }
            for (let mvarr_i = 0; mvarr_i < mvarr[a].length; mvarr_i++) {
                let res = mvarr[a][mvarr_i][2] + mvarr[a][mvarr_i][5];
                // console.log(res);
                let decUrl = decr_sun(mvarr[a][mvarr_i][1], mvarr[a][mvarr_i][3], mvarr[a][mvarr_i][4], mvarr[a][mvarr_i][0]);
                //log(decUrl)
                list.push({
                    'title': a.replace("28", "DO").replace("29", "ğŸ”¥ST").replace("37", "ğŸ”¥SW").replace("38", "ğŸ”¥VH").replace("39", "EM").replace("40", "ğŸ”¥TV").replace("41", "US").replace("42", "SP"),
                    'url': decUrl.startsWith('//') ? `https:${decUrl}` : decUrl.replace(/http.*?(http.*)/, "$1")
                });
            }
        }
        server.forEach(x => {
            jfun_show_mvinnerHTML(x);
        })

        var lazy = $('').lazyRule(() => {
            // å®šä¹‰ä¸€ä¸ªè§£æåˆ†è¾¨ç‡çš„å‡½æ•°
            function getResolution(name) {
                var match = name.match(/(\d+)/); // æå–é™çº§åˆ†è¾¨ç‡
                return match ? parseInt(match[1], 10) : 0; // å¦‚æœæ²¡æœ‰åŒ¹é…åˆ™è¿”å›0
            }
            let videoUrl = '';
            var html = fetch(input)
            //log(html)
            if (input.indexOf("7mmtv.sx/assets") != -1) {
                //TVçº¿è·¯42    
                var group = html.match(/const videoSources[^;]+/)[0]
                eval(group)
                sortedData = videoSources.sort((a, b) => b.size - a.size);
                var sortedNames = sortedData.map(item => item.size);
                var sortedUrls = sortedData.map(item => item.src);
                let playlist = JSON.stringify({
                    names: sortedNames,
                    urls: sortedUrls,
                    headers: new Array(sortedData.length).fill({
                        Referer: "https://7mmtv.sx/"
                    })
                });
                return playlist;
            } else if (input.indexOf("7mmtv.sx") != -1) {
                //TVçº¿è·¯40               
                var s = html.match(/src.?=[^\>]+/)[0];
                eval(s)
                var request = fetch(src);
                let playUrl = request.match(/https.*?m3u8/)[0];
                var group_quality = fetch(playUrl, {
                    headers: {
                        'Referer': input
                    }
                });
                //log(group_quality)
                hghest_quality = group_quality.match(/^[^#\s]+$/gm).map(v => v.includes("http") ? v + "#isVideo=true#" : playUrl.replace(/[^\/]+$/, v))
                //log(hghest_quality)
                name_quality = group_quality.match(/RESOLUTION=.*?\,/gm).map(n => n.replace(/RESOLUTION=|\,/g, ""))

                // æŒ‰åˆ†è¾¨ç‡é™åºæ’åº åˆ†è¾¨ç‡ æ•°ç»„ï¼Œå¹¶åŒæ—¶è°ƒæ•´ hghest_quality
                var sortedData = name_quality.map((name, index) => ({
                        name,
                        url: hghest_quality[index]
                    }))
                    .sort((a, b) => getResolution(b.name) - getResolution(a.name));
                // åˆ†å¼€æ’åºåçš„ names å’Œ urls æ•°ç»„
                var sortedNames = sortedData.map(item => item.name);
                var sortedUrls = sortedData.map(item => item.url);
                let playlist = JSON.stringify({
                    names: sortedNames,
                    urls: sortedUrls,
                    headers: new Array(hghest_quality.length).fill({
                        Referer: "https://mmtv01.xyz/"
                    })
                });
                return playlist;
            } else if (input.indexOf("upns") != -1) {
                //USçº¿è·¯41
                //https://7mmtv.upns.live/#6kx1
                var url = "https://7mmtv.upns.live/api/v1/video?id=" + input.split("#")[1]
                var data = fetch(url)
                var Decode = (word) => {
                    word = word.trim()
                    eval(getCryptoJS())
                    let key = CryptoJS.enc.Utf8.parse("kiemtienmua911ca")
                    let iv = CryptoJS.enc.Utf8.parse("1234567890oiuytr")
                    return CryptoJS.AES.decrypt(CryptoJS.enc.Base64.stringify(CryptoJS.enc.Hex.parse(word)), key, {
                        iv: iv,
                        mode: CryptoJS.mode.CBC,
                        padding: CryptoJS.pad.Pkcs7
                    }).toString(CryptoJS.enc.Utf8)
                }
                var json = JSON.parse(Decode(data))
                return json.cf + '#isVideo=true#;{Origin@https://7mmtv.upns.live&&Referer@https://7mmtv.upns.live/}'

            } else if (input.indexOf("mm") != -1) {
                //çº¿è·¯SW37+VHçº¿è·¯38
                var script = html.match(/eval(.*\))/)[1]
                playUrl = eval(script).match(/(https?.*?)"/)[1]
                var group_quality = fetch(playUrl, {
                    headers: {
                        'Referer': input
                    }
                });
                group_quality = group_quality.split("\n\n")[0]
                // log(group_quality)
                hghest_quality = group_quality.match(/^[^#\s]+$/gm).map(v => v.includes("http") ? v + "#isVideo=true#" : playUrl.replace(/[^\/]+$/, v + "#.m3u8"))
                //log(hghest_quality)
                name_quality = group_quality.match(/RESOLUTION=.*?\,/gm).map(n => n.replace(/RESOLUTION=|\,/g, ""))

                // æŒ‰åˆ†è¾¨ç‡é™åºæ’åº åˆ†è¾¨ç‡ æ•°ç»„ï¼Œå¹¶åŒæ—¶è°ƒæ•´ hghest_quality
                var sortedData = name_quality.map((name, index) => ({
                        name,
                        url: hghest_quality[index]
                    }))
                    .sort((a, b) => getResolution(b.name) - getResolution(a.name));
                // åˆ†å¼€æ’åºåçš„ names å’Œ urls æ•°ç»„
                var sortedNames = sortedData.map(item => item.name);
                var sortedUrls = sortedData.map(item => item.url);
                let playlist = JSON.stringify({
                    names: sortedNames,
                    urls: sortedUrls,
                    headers: new Array(hghest_quality.length).fill({
                        Referer: "https://7mmtv.upns.live/"
                    })
                });
                return playlist;
            } else if (input.indexOf("embedrise") != -1) {
                //EMçº¿è·¯39
                var url = pdfh(html, "source&&src");
                playUrl = url + "#isVideo=true#;{Referer@" + getHome(input) + "/}"
                return playUrl
            } else if (input.indexOf('dooood') != -1) {
                //DOçº¿è·¯28
                var redirect = JSON.parse(fetch(input, {
                    onlyHeaders: true
                })).url;
                var htmll = fetch(redirect, {
                    headers: {
                        referer: input
                    }
                });
                // log(htmll)
                var pass_md5 = getHome(redirect) + htmll.match(/\/pass_md5[^"']+/)[0]
                var token = htmll.match(/cookieIndex.*?\'(.*?)\'/)[1]
                var data = fetch(pass_md5, {
                    headers: {
                        "Referer": redirect
                    }
                })

                function makePlay(token) {
                    for (var a = "",
                            t = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
                            n = t.length,
                            o = 0; 10 > o; o++)
                        a += t.charAt(Math.floor(Math.random() * n));
                    return a + "?token=" + token + "&expiry=" + Date.now();
                };
                var playUrl = data + makePlay(token)
                return playUrl + "#isVideo=true#;{Referer@" + input + "}"

            } else if (input.indexOf('tapewithadblock') != -1) {
                //STçº¿è·¯29
                var pattern = html.match(/\('#(.*)'\)/)[1]
                var src = "var srclink = " + html.match(new RegExp("'" + pattern + ".*?=([^;]+)"))[1]
                eval(src)
                var link = "https:" + srclink + "&stream=1"
                var urlPlay = JSON.parse(fetch(link, {
                    headers: {
                        "Referer": input,
                    },
                    onlyHeaders: true
                })).url
                videoUrl = urlPlay + ";{Referer@" + input + "}"

            } else {
                log(input)
                videoUrl = "toast://çº¿è·¯æš‚æœªè§£æ=>" + input
            }
            return videoUrl;
        })
        //log(list)
        var col;
        if (list.length == 1) {
            col = "text_2"
        } else if (list.length < 6) {
            col = "text_" + list.length
        } else if (list.length < 11) {
            col = "text_" + Math.ceil(list.length / 2)
        } else {
            col = "text_5"
        }

        list.forEach((item, index) => {
            Apollo.d.push({
                title: item.title,
                url: item.url + lazy,
                col_type: col
            })
        })
    },
    //å¤–é“¾æ’­æ”¾
    CodeParse: (è¯†åˆ«ç ) => {
        Apollo.d.push({
            col_type: 'blank_block',
        })
        var codelazy = fetch('hiker://files/rules/Apollo/ğ‚ğ¨ğğğ‹ğšğ³ğ².js')
            .replace(/d\.push/g, "Apollo.d.push") || "";

        function downcode() {
            var js = fetch("https://raw.githubusercontent.com/ApolloRioo/R/master/ğ‚ğ¨ğğğ‹ğšğ³ğ²");
            writeFile('hiker://files/rules/Apollo/ğ‚ğ¨ğğğ‹ğšğ³ğ².js', js);
            toast("è¿œç¨‹æ•°æ®å·²æ›´æ–°åˆ°æœ¬åœ°")
            codelazy = fetch('hiker://files/rules/Apollo/ğ‚ğ¨ğğğ‹ğšğ³ğ².js')
                .replace(/d\.push/g, "Apollo.d.push")
        }
        if (!codelazy) {
            downcode()
        }
        try {
            eval(codelazy)
        } catch {
            downcode()
            eval(codelazy)
            log("è¯»å–å¤±è´¥æ›´æ–°è¿œç¨‹æ•°æ®")
        }
        CodeLazy(è¯†åˆ«ç )
    }

}

$.exports = Apollo